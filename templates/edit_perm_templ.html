<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="index.php">{% trans %}Home{% endtrans %}</a></li>
        <li class="breadcrumb-item"><a href="index.php?page=users">{% trans %}Users{% endtrans %}</a></li>
        <li class="breadcrumb-item"><a href="index.php?page=list_perm_templ">{% trans %}Permission templates{% endtrans %}</a></li>
        <li class="breadcrumb-item" aria-current="page">{% trans %}Edit{% endtrans %}</li>
    </ol>
</nav>

<h5 class="mb-3" data-testid="edit-permission-template-heading">{% trans %}Edit permission template{% endtrans %}</h5>
<form class="needs-validation" method="post" action="" novalidate data-testid="edit-permission-template-form">
    <input type="hidden" name="_token" value="{{ csrf_token }}">
    <input type="hidden" name="templ_id" value="{{ id }}">

    <div class="col-sm-3">
        <div class="mb-2">
            <label for="templ_name" class="form-label">{% trans %}Name{% endtrans %}</label>
            <input class="form-control form-control-sm" type="text" id="templ_name" name="templ_name" value="{{ templ['name'] }}" required data-testid="template-name-input">
            <div class="invalid-feedback" data-testid="template-name-error">{% trans %}Provide a name for your template{% endtrans %}</div>
        </div>
        <div class="mb-2">
            <label for="templ_descr" class="form-label">{% trans %}Description{% endtrans %}</label>
            <input class="form-control form-control-sm" type="text" id="templ_descr" name="templ_descr" value="{{ templ['descr'] }}" data-testid="template-description-input">
        </div>
    </div>

    <hr>

    <table class="table table-striped table-hover table-sm" data-testid="permissions-table">
        <thead>
        <tr>
            <th>&nbsp;</th>
            <th>{% trans %}Name{% endtrans %}</th>
            <th>{% trans %}Description{% endtrans %}</th>
        </tr>
        </thead>

        <tbody data-testid="permissions-tbody">
        {% for permission in perms_avail %}
        <tr data-testid="permission-row-{{ permission['id'] }}">
            {% set descr = permission['descr'] %}
            {% set has_perm = "" %}
            {% for template in perms_templ %}
            {% if permission['id'] in template %}
            {% set has_perm = "checked" %}
            {% endif %}
            {% endfor %}
            <td><input class="form-check-input" type="checkbox" name="perm_id[]" value="{{ permission['id'] }}" {{ has_perm }} data-testid="permission-checkbox-{{ permission['id'] }}"></td>
            <td data-testid="permission-name-{{ permission['id'] }}">{{ permission['name'] }}</td>
            <td>{{ descr|trans }}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    <input type="submit" class="btn btn-primary btn-sm" name="commit" value="{% trans %}Update{% endtrans %}" data-testid="submit-template-button">
</form>